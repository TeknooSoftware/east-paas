# Learn more about services, parameters and containers at
# http://symfony.com/doc/current/service_container.html
parameters:
  teknoo.paas.normalizer.exception.class: 'Teknoo\East\Paas\Infrastructures\Symfony\Normalizer\ExceptionNormalizer'
  teknoo.paas.normalizer.class_finder_denormalizer.class: 'Teknoo\East\Paas\Infrastructures\Symfony\Normalizer\ClassFinderDenormalizer'
  teknoo.paas.normalizer.history_denormalizer.class: 'Teknoo\East\Paas\Infrastructures\Symfony\Normalizer\HistoryDenormalizer'
  teknoo.paas.normalizer.job_unit_denormalizer.class: 'Teknoo\East\Paas\Infrastructures\Symfony\Normalizer\JobUnitDenormalizer'
  teknoo.paas.messenger.sender.guzzle.class: 'Teknoo\East\Paas\Infrastructures\Symfony\Messenger\Transport\GuzzleTransport'
  teknoo.east.symfony.normalizer.east_normalizer.class: 'Teknoo\East\Paas\Infrastructures\Symfony\Normalizer\EastNormalizer'

  teknoo.paas.end_point.new_job.class: 'Teknoo\East\Foundation\EndPoint\RecipeEndPoint'
  teknoo.paas.end_point.job_add_history.class: 'Teknoo\East\Foundation\EndPoint\RecipeEndPoint'
  teknoo.paas.end_point.job_run.class: 'Teknoo\East\Foundation\EndPoint\RecipeEndPoint'

  locale: 'en'
  router.request_context.host: 'teknoo.software'
  router.request_context.scheme: 'https'
  teknoo.east.website.form_type.doctrine.class: 'MockDoctrineType'

services:
  Doctrine\Persistence\ObjectRepository:
    synthetic: true

  doctrine_mongodb.odm.default_document_manager:
    synthetic: true

  security.encoder_factory:
    synthetic: true

  Teknoo\East\Paas\Infrastructures\Symfony\Normalizer\ExceptionNormalizer:
    class: '%teknoo.paas.normalizer.exception.class%'
    tags:
      - {name: 'serializer.normalizer', priority: 100}

  Teknoo\East\Paas\Infrastructures\Symfony\Normalizer\ClassFinderDenormalizer:
    class: '%teknoo.paas.normalizer.class_finder_denormalizer.class%'
    calls:
      - ['setDenormalizer', ['@serializer']]
    tags:
      - {name: 'serializer.normalizer', priority: 10}

  Teknoo\East\Paas\Infrastructures\Symfony\Normalizer\HistoryDenormalizer:
    class: '%teknoo.paas.normalizer.history_denormalizer.class%'
    tags:
      - {name: 'serializer.normalizer', priority: 100}

  Teknoo\East\Paas\Infrastructures\Symfony\Normalizer\JobUnitDenormalizer:
    class: '%teknoo.paas.normalizer.job_unit_denormalizer.class%'
    calls:
      - ['setDenormalizer', ['@serializer']]
    tags:
      - {name: 'serializer.normalizer', priority: 100}

  Teknoo\East\Paas\Infrastructures\Symfony\Messenger\Transport\TransportFactory:
    arguments:
      - '@Teknoo\East\Paas\Infrastructures\Symfony\Messenger\Transport\GuzzleTransport'
      - 'tkpaas://'
    tags:
      - 'messenger.transport_factory'

  Teknoo\East\Paas\Infrastructures\Symfony\Messenger\Transport\GuzzleTransport:
    class: '%teknoo.paas.messenger.sender.guzzle.class%'
    arguments:
      - '@GuzzleHttp\Client'
      - '@logger'

  Psr\Http\Message\ServerRequestFactoryInterface:
    class: 'Laminas\Diactoros\ServerRequestFactory'

  Psr\Http\Message\UploadedFileFactoryInterface:
    class: 'Laminas\Diactoros\UploadedFileFactory'

  teknoo.east.website.endpoint.media.stream.factory:
    class: 'Laminas\Diactoros\StreamFactory'

  teknoo.paas.end_point.new_job:
    class: '%teknoo.paas.end_point.new_job.class%'
    public: true
    arguments:
      - '@Teknoo\East\Paas\Contracts\Recipe\NewJobRecipe'

  teknoo.paas.end_point.job_add_history:
    class: '%teknoo.paas.end_point.job_add_history.class%'
    public: true
    arguments:
      - '@Teknoo\East\Paas\Contracts\Recipe\AddHistoryRecipe'

  teknoo.paas.end_point.job_run:
    class: '%teknoo.paas.end_point.job_run.class%'
    public: true
    arguments:
      - '@Teknoo\East\Paas\Contracts\Recipe\RunJobRecipe'

  property_accessor:
    public: true
    class: 'Symfony\Component\PropertyAccess\PropertyAccessor'
    arguments:
      - false
      - false
      - '@?cache.property_access'